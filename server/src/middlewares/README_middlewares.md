# Руководство по Middleware компонентам

## Обзор
Эта директория содержит промежуточные обработчики (middleware), используемые в приложении Express.js для обработки запросов, аутентификации и обработки ошибок.

## Основные компоненты

### verifyTokens.js
Middleware для аутентификации и авторизации:
- `verifyRefreshToken`: Проверяет refresh токены из cookies
- `verifyAccessToken`: Проверяет access токены из заголовка Authorization
- `verifyAdmin`: Проверяет права администратора

### errorHandler.js
Централизованный обработчик ошибок:
- Обрабатывает ошибки валидации
- Обрабатывает ошибки аутентификации
- Управляет ошибками базы данных
- Форматирует ответы об ошибках

### checkResource.js
Middleware для валидации ресурсов:
- Проверяет существование ресурса по ID
- Генерирует NotFoundError при необходимости
- Прикрепляет найденные ресурсы к объекту запроса

## Добавление новых Middleware

При создании новых компонентов middleware:

1. Именование файлов:
   - Используйте описательные имена
   - Следуйте шаблону: `назначениеMiddleware.js`

2. Рекомендации по реализации:
   - Принцип единой ответственности
   - Понятные имена функций
   - Обработка ошибок через next(error)
   - Документирование параметров и поведения

3. Обработка ошибок:
   - Используйте единый формат ошибок
   - Передавайте ошибки в errorHandler
   - Включайте соответствующие коды статусов

4. Документация:
   - Добавляйте JSDoc комментарии
   - Обновляйте этот README
   - Включайте примеры использования

## Пример использования

```javascript
const { verifyAccessToken, verifyAdmin } = require ('./middlewares/verifyTokens');

router.get('/protected',
  verifyAccessToken,  // Сначала проверяем токен
  verifyAdmin,        // Затем проверяем права админа
  (req, res) => {
    // Обработчик маршрута
  }
);
```